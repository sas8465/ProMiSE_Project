library(TraMineR)

P1 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P1_Cleaned.csv')
P2 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P2_Cleaned.csv')
P3 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P3_Cleaned.csv')
P4 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P4_Cleaned.csv')
P5 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P5_Cleaned.csv')
P6 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P6_Cleaned.csv')
P7 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P7_Cleaned.csv')
P8 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P8_Cleaned.csv')
P9 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P9_Cleaned.csv')
P10 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P10_Cleaned.csv')
P11 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P11_Cleaned.csv')
P12 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P12_Cleaned.csv')
P13 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P13_Cleaned.csv')
P14 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P14_Cleaned.csv')
P15 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P15_Cleaned.csv')
P16 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P16_Cleaned.csv')
P17 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P17_Cleaned.csv')
P18 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P18_Cleaned.csv')
P19 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P19_Cleaned.csv')
P20 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P20_Cleaned.csv')
P21 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P21_Cleaned.csv')
P22 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P22_Cleaned.csv')
P23 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P23_Cleaned.csv')
P24 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P24_Cleaned.csv')
P25 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P25_Cleaned.csv')
P26 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P26_Cleaned.csv')
P27 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P27_Cleaned.csv')
P28 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P28_Cleaned.csv')
P29 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P29_Cleaned.csv')
P30 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P30_Cleaned.csv')
P31 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P31_Cleaned.csv')
P32 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P32_Cleaned.csv')
P33 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P33_Cleaned.csv')
P34 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P34_Cleaned.csv')
P36 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P36_Cleaned.csv')
P37 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P37_Cleaned.csv')
P38 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P38_Cleaned.csv')
P39 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P39_Cleaned.csv')
P41 <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/P41_Cleaned.csv')

labeling_system <- read.csv('C:/Users/leal0/OneDrive/Desktop/Documents/St. Gallen/Process Mining Job/How Codes Cleaned Data (Top 30 Codes)/Unique_Second_Code_Combinations.csv')

# We create a new dataframe using the transpose of a matrix

P1_transpose<-as.data.frame(t(P1$V22))
colnames(P1_transpose) <- seq(1, ncol(P1_transpose), by=1)

P2_transpose<-as.data.frame(t(P2$V22))
colnames(P2_transpose) <- seq(1, ncol(P2_transpose), by=1)

P3_transpose<-as.data.frame(t(P3$V22))
colnames(P3_transpose) <- seq(1, ncol(P3_transpose), by=1)

P4_transpose<-as.data.frame(t(P4$V22))
colnames(P4_transpose) <- seq(1, ncol(P4_transpose), by=1)

P5_transpose<-as.data.frame(t(P5$V22))
colnames(P5_transpose) <- seq(1, ncol(P5_transpose), by=1)

P6_transpose<-as.data.frame(t(P6$V22))
colnames(P6_transpose) <- seq(1, ncol(P6_transpose), by=1)

P7_transpose<-as.data.frame(t(P7$V22))
colnames(P7_transpose) <- seq(1, ncol(P7_transpose), by=1)

P8_transpose<-as.data.frame(t(P8$V22))
colnames(P8_transpose) <- seq(1, ncol(P8_transpose), by=1)

P9_transpose<-as.data.frame(t(P9$V22))
colnames(P9_transpose) <- seq(1, ncol(P9_transpose), by=1)

P10_transpose<-as.data.frame(t(P10$V22))
colnames(P10_transpose) <- seq(1, ncol(P10_transpose), by=1)

P11_transpose<-as.data.frame(t(P11$V22))
colnames(P11_transpose) <- seq(1, ncol(P11_transpose), by=1)

P12_transpose<-as.data.frame(t(P12$V22))
colnames(P12_transpose) <- seq(1, ncol(P12_transpose), by=1)

P13_transpose<-as.data.frame(t(P13$V22))
colnames(P13_transpose) <- seq(1, ncol(P13_transpose), by=1)

P14_transpose<-as.data.frame(t(P14$V22))
colnames(P14_transpose) <- seq(1, ncol(P14_transpose), by=1)

P15_transpose<-as.data.frame(t(P15$V22))
colnames(P15_transpose) <- seq(1, ncol(P15_transpose), by=1)

P16_transpose<-as.data.frame(t(P16$V22))
colnames(P16_transpose) <- seq(1, ncol(P16_transpose), by=1)

P17_transpose<-as.data.frame(t(P17$V22))
colnames(P17_transpose) <- seq(1, ncol(P17_transpose), by=1)

P18_transpose<-as.data.frame(t(P18$V22))
colnames(P18_transpose) <- seq(1, ncol(P18_transpose), by=1)

P19_transpose<-as.data.frame(t(P19$V22))
colnames(P19_transpose) <- seq(1, ncol(P19_transpose), by=1)

P20_transpose<-as.data.frame(t(P20$V22))
colnames(P20_transpose) <- seq(1, ncol(P20_transpose), by=1)

P21_transpose<-as.data.frame(t(P21$V22))
colnames(P21_transpose) <- seq(1, ncol(P21_transpose), by=1)

P22_transpose<-as.data.frame(t(P22$V22))
colnames(P22_transpose) <- seq(1, ncol(P22_transpose), by=1)

P23_transpose<-as.data.frame(t(P23$V22))
colnames(P23_transpose) <- seq(1, ncol(P23_transpose), by=1)

P24_transpose<-as.data.frame(t(P24$V22))
colnames(P24_transpose) <- seq(1, ncol(P24_transpose), by=1)

P25_transpose<-as.data.frame(t(P25$V22))
colnames(P25_transpose) <- seq(1, ncol(P25_transpose), by=1)

P26_transpose<-as.data.frame(t(P26$V22))
colnames(P26_transpose) <- seq(1, ncol(P26_transpose), by=1)

P27_transpose<-as.data.frame(t(P27$V22))
colnames(P27_transpose) <- seq(1, ncol(P27_transpose), by=1)

P28_transpose<-as.data.frame(t(P28$V22))
colnames(P28_transpose) <- seq(1, ncol(P28_transpose), by=1)

P29_transpose<-as.data.frame(t(P29$V22))
colnames(P29_transpose) <- seq(1, ncol(P29_transpose), by=1)

P30_transpose<-as.data.frame(t(P30$V22))
colnames(P30_transpose) <- seq(1, ncol(P30_transpose), by=1)

P31_transpose<-as.data.frame(t(P31$V22))
colnames(P31_transpose) <- seq(1, ncol(P31_transpose), by=1)

P32_transpose<-as.data.frame(t(P32$V22))
colnames(P32_transpose) <- seq(1, ncol(P32_transpose), by=1)

P33_transpose<-as.data.frame(t(P33$V22))
colnames(P33_transpose) <- seq(1, ncol(P33_transpose), by=1)

P34_transpose<-as.data.frame(t(P34$V22))
colnames(P34_transpose) <- seq(1, ncol(P34_transpose), by=1)

P36_transpose<-as.data.frame(t(P36$V22))
colnames(P36_transpose) <- seq(1, ncol(P36_transpose), by=1)

P37_transpose<-as.data.frame(t(P37$V22))
colnames(P37_transpose) <- seq(1, ncol(P37_transpose), by=1)

P38_transpose<-as.data.frame(t(P38$V22))
colnames(P38_transpose) <- seq(1, ncol(P38_transpose), by=1)

P39_transpose<-as.data.frame(t(P39$V22))
colnames(P39_transpose) <- seq(1, ncol(P39_transpose), by=1)

P41_transpose<-as.data.frame(t(P41$V22))
colnames(P41_transpose) <- seq(1, ncol(P41_transpose), by=1)

#Joining them all into a single data frame:

participant_sequences <- P1_transpose %>% full_join(P2_transpose)
participant_sequences <- participant_sequences %>% full_join(P3_transpose)
participant_sequences <- participant_sequences %>% full_join(P4_transpose)
participant_sequences <- participant_sequences %>% full_join(P5_transpose)
participant_sequences <- participant_sequences %>% full_join(P6_transpose)
participant_sequences <- participant_sequences %>% full_join(P7_transpose)
participant_sequences <- participant_sequences %>% full_join(P8_transpose)
participant_sequences <- participant_sequences %>% full_join(P9_transpose)
participant_sequences <- participant_sequences %>% full_join(P10_transpose)
participant_sequences <- participant_sequences %>% full_join(P11_transpose)
participant_sequences <- participant_sequences %>% full_join(P12_transpose)
participant_sequences <- participant_sequences %>% full_join(P13_transpose)
participant_sequences <- participant_sequences %>% full_join(P14_transpose)
participant_sequences <- participant_sequences %>% full_join(P15_transpose)
participant_sequences <- participant_sequences %>% full_join(P16_transpose)
participant_sequences <- participant_sequences %>% full_join(P17_transpose)
participant_sequences <- participant_sequences %>% full_join(P18_transpose)
participant_sequences <- participant_sequences %>% full_join(P19_transpose)
participant_sequences <- participant_sequences %>% full_join(P20_transpose)
participant_sequences <- participant_sequences %>% full_join(P21_transpose)
participant_sequences <- participant_sequences %>% full_join(P22_transpose)
participant_sequences <- participant_sequences %>% full_join(P23_transpose)
participant_sequences <- participant_sequences %>% full_join(P24_transpose)
participant_sequences <- participant_sequences %>% full_join(P25_transpose)
participant_sequences <- participant_sequences %>% full_join(P26_transpose)
participant_sequences <- participant_sequences %>% full_join(P27_transpose)
participant_sequences <- participant_sequences %>% full_join(P28_transpose)
participant_sequences <- participant_sequences %>% full_join(P29_transpose)
participant_sequences <- participant_sequences %>% full_join(P30_transpose)
participant_sequences <- participant_sequences %>% full_join(P31_transpose)
participant_sequences <- participant_sequences %>% full_join(P32_transpose)
participant_sequences <- participant_sequences %>% full_join(P33_transpose)
participant_sequences <- participant_sequences %>% full_join(P34_transpose)
participant_sequences <- participant_sequences %>% full_join(P36_transpose)
participant_sequences <- participant_sequences %>% full_join(P37_transpose)
participant_sequences <- participant_sequences %>% full_join(P38_transpose)
participant_sequences <- participant_sequences %>% full_join(P39_transpose)
participant_sequences <- participant_sequences %>% full_join(P41_transpose)

#Defining the Sequence Form 1:

uniq <- as.vector(as.matrix(participant_sequences))
print(unique(uniq))

#Subsetting specific values:

participant_sequences[participant_sequences=="V8"] <- 'V'
participant_sequences[participant_sequences=="V9"] <- 'V'
participant_sequences[participant_sequences=="V10"] <- 'V'
participant_sequences[participant_sequences=="V11"] <- 'V'
participant_sequences[participant_sequences=="V12"] <- 'V'
participant_sequences[participant_sequences=="V13"] <- 'V'
participant_sequences[participant_sequences=="V14"] <- 'V'
participant_sequences[participant_sequences=="V15"] <- 'V'
participant_sequences[participant_sequences=="V16"] <- 'V'
participant_sequences[participant_sequences=="V17"] <- 'V'
participant_sequences[participant_sequences=="V18"] <- 'V'
participant_sequences[participant_sequences=="V19"] <- 'V'
participant_sequences[participant_sequences=="V20"] <- 'V'
participant_sequences[participant_sequences=="V21"] <- 'V'
participant_sequences[participant_sequences=="V22"] <- 'V'
participant_sequences[participant_sequences=="V23"] <- 'V'
participant_sequences[participant_sequences=="V24"] <- 'V'
participant_sequences[participant_sequences=="V25"] <- 'V'
participant_sequences[participant_sequences=="V26"] <- 'V'
participant_sequences[participant_sequences=="V27"] <- 'V'
participant_sequences[participant_sequences=="V28"] <- 'V'
participant_sequences[participant_sequences=="V29"] <- 'V'
participant_sequences[participant_sequences=="V30"] <- 'V'

#Checking Subset is correct:

uniq <- as.vector(as.matrix(participant_sequences))
print(unique(uniq))

#Defining the Sequence Form:

participant.alphab <- c("V", "V1", "V2", "V3", "V4", "V5", "V6", "V7")

participant.lab <- c("Miscellaneous", "Directly-Follow", "TabRepr", "None", "TextDocu", "TraveVariantVis", "Dotted Chart", "Line Graph")

participant.scode <- c("V", "V1", "V2", "V3", "V4", "V5", "V6", "V7")

participant.seq <- seqdef(participant_sequences, alphabet = participant.alphab, labels = participant.lab, states = participant.scode)

seqiplot(participant.seq, border = NA, main="Sample of P1 to P10 How Code Sequence", with.legend	="right")

#Ploting All Participants

seqiplot(participant.seq[1:10,], border = NA, main="Sample of P1 to P10 How Code Sequence", with.legend	="right")
seqiplot(participant.seq[11:20,], border = NA, main="Sample of P11 to P20 How Code Sequence", with.legend	="right")
seqiplot(participant.seq[21:30,], border = NA, main="Sample of P21 to P30 How Code Sequence", with.legend	="right")
seqiplot(participant.seq[31:39,], border = NA, main="Sample of P31 to P41 How Code Sequence", with.legend	="right")



participant.seq <- seqdef(participant_sequences)

seqiplot(participant.seq, border = NA, main="Sample of P1 to P10 How Code Sequence Visualization", with.legend	="right")






#Algorithmic Analysis:

participant.trate <- seqtrate(participant.seq)
round(participant.trate, 2)


seqstatd(participant.seq)

seqistatd(participant.seq)

participant.om <- seqdist(participant.seq, norm = 'auto', method="LCP")

#seqrep(participant.seq, method = 'LCP', criterion = "dist") 

#mvad.om <- seqdist(mvad.seq, method = "OM", indel = 1, sm = "TRATE")

library("cluster")

clusterward <- agnes(participant.om, diss = TRUE, method = "ward")
participant.cl4 <- cutree(clusterward, k = 2)
cl4.lab <- factor(participant.cl4, labels = paste("Cluster", 1:2))

seqdplot(participant.seq, group = cl4.lab, border = NA)

clusterward <- agnes(participant.om, diss = TRUE, method = "ward")
participant.cl4 <- cutree(clusterward, k = 4)
cl4.lab <- factor(participant.cl4, labels = paste("Cluster", 1:4))

seqdplot(participant.seq, group = cl4.lab, border = NA)

clusterward <- agnes(participant.om, diss = TRUE, method = "ward")
participant.cl4 <- cutree(clusterward, k = 6)
cl4.lab <- factor(participant.cl4, labels = paste("Cluster", 1:6))

seqdplot(participant.seq, group = cl4.lab, border = NA)

clusterward <- agnes(participant.om, diss = TRUE, method = "ward")
participant.cl4 <- cutree(clusterward, k = 8)
cl4.lab <- factor(participant.cl4, labels = paste("Cluster", 1:8))

seqdplot(participant.seq, group = cl4.lab, border = NA)

